<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
    <div class="crypt">
        <label>Qual texto deseja Criptografar ?</label><br>
        <textarea id="texto" name="texto" class="texto" rows="4" cols="50">
        </textarea>
    </div>
    <div class="downloadcrypt">
        <button id="downloadcrypt">Download Criptografado</button>
    </div>
    <div align="left" class="decrypt"> </br>
        <label>Fa√ßa Upload e baixe descriptografado</label><br>
        <form action="http://localhost:3000/decrypt" method="post" enctype="multipart/form-data">
            <input type="file" name="decrypt"><br>
            <input type="submit" value="Download">
        </form>
    </div>
</body>

</html>

<script>

    let btnDown = document.querySelector('#downloadcrypt')
    btnDown.addEventListener('click', (e) => {
        let texto = document.getElementById('texto').value
        axios({
            url: `http://localhost:3000/crypt/${texto}`,
            method: 'GET',
            responseType: 'blob', // important
        }).then((response) => {
            const url = window.URL.createObjectURL(new Blob([response.data]));
            console.log(response.data)
            const link = document.createElement('a');
            link.href = url;
            link.setAttribute('download', 'Crypt.txt');
            document.body.appendChild(link);
            link.click();
        });

    })

</script>
